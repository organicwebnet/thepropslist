import React, { useState, useEffect, useCallback } from 'react';
import { View, Text, TextInput, Button, StyleSheet, ScrollView, ActivityIndicator, Alert, TouchableOpacity, Image, Platform, Switch } from 'react-native';
import { useLocalSearchParams, useRouter } from 'expo-router';
import { WebView } from 'react-native-webview';
import { usePacking } from '../../../src/hooks/usePacking.ts';
import { useShow } from '../../../src/hooks/useShow.ts';
import { PackingBox, PackedProp } from '../../../src/types/packing.ts';
import { Show } from '../../../src/types/index.ts';
import * as Print from 'expo-print';
import QRCodeLib from 'qrcode';
import { useAuth } from '../../../src/contexts/AuthContext.tsx';
import { Address } from '../../../src/shared/types/address.ts';
import { AddressSelectionModal } from '../../../src/shared/components/AddressSelectionModal.tsx';

// Import images using relative paths with .webp extension
import handleCareImage from '../../../assets/packing-symbols/handle-care.webp';
import fragileImage from '../../../assets/packing-symbols/fragile.webp';
import thisWayUpImage from '../../../assets/packing-symbols/this-way-up.webp';
import keepDryImage from '../../../assets/packing-symbols/keep-dry.webp';
import batteryIncluded from '../../../assets/packing-symbols/battery-included.webp';

// Base64 encoded image data URLs.
// const HANDLE_CARE_BASE64 = 'data:image/webp;base64,UklGRqACAABXRUJQVlA4WAoAAAAQAAAAxwAAxwAAQUxQSAMCAAABDzD/ERFCbqtt1di8iIKSNh2LREJZLJDKpUfIKEHybQ0sL4A7LBHe4oePL/dLFdH/CeBvN7SZ1OZ/DO/1qFZotRqd1mDQIpNSJml0Kkmn00kGnUkyqmReVcrCarSF1xiLqMG1QtmYs7ZxZ2MT9OJZ2/izurFneYOjbOYiZXNk+yLUM18Xrh0M5JgXZhhEyTSZuCTQ5CShzbSDZCg0hSeukfSNpkoyXWYoJG3XSCCJeTEHNJMxU8V2+qrjK23TiZlm6BAfQSX7rmg5NK2ArpUwtfiJanf/IeAEu3Q2NvGsbfyJQdlYFBmADQBR6gZzEVG8bDj0RUCNUxKnQ104tBOPvDBoacgCcElAP4nA4B0jMBQa7+gVElB4RwvMg0EAvCMAxilJi3kXgXzATgP0u3AJFDVaoN45oNDLXumAfGeAyhvZywUfcHmS3dFj3fgiu2HYdD7LbgWDrzLPKOiyMNNmpoM4uWEcsjQkkxB1mkVmoARko10U+pPXTeUtk2TymW7zJBu8o1803jFKOp82nc8MsluGzaus8ZZxMfhGL6n8zLSYfKOTfdmQX2klhSQ3lOWLAZAvRqVcIMHF6kySDkAlmWSDpAfQSEa9IOskA4B+1kReZ5B0skoy6hSRlWWR+U4gwsEUJL14MvS6IOj5k6ZXBe6kCOy/p0yGlTlR/EdHNf52AwBWUDggdgAAAFAMAJ0BKsgAyAA+bTaZSaQjIqEgSACADYlpbuF2sRtAE9r0VcIMghqqTXbaLhBkENVSa7bRcIMghqqTXbaLhBkENVSa7bRcIMghqqTXbaLhBkENVSa7bRcIMghqqTXbaLhBkENVSa7bRZwAAP7/1gAAAAAAAAA=';
// const FRAGILE_BASE64 = 'data:image/webp;base64,UklGRngBAABXRUJQVlA4WAoAAAAQAAAAxwAAxwAAQUxQSNsAAAABDzD/ERECcmzbbZuviCVLQCksLRam1AjdAbxLGDyHj8FDcPYiov8TgE+3sDHQws/eGZAAwPA6DoobPoaxvL4p54bYpqzldRnEteShOJPDVxBYMBXs0JClghvvUsFdBfc8V8FDBb68QTGUUAHK63kn1hjZMfSSJLJpQtCE4HMNjAelL8oplrEqHeOsGMao7BiibCjhnVA8gIHjAFjOGUDHGQHsOOIxCGlFxxJs/r0ZsWMB2HAcAMsJAEA5471hOMUyvAIG9E3aOWLSXMSmPUT6NB8Z0tJ/6EDDpxsAVlA4IHYAAABQDACdASrIAMgAPm02mUmkIyKhIEgAgA2JaW7hdrEbQBPa9FXCDIIaqk122i4QZBDVUmu20XCDIIaqk122i4QZBDVUmu20XCDIIaqk122i4QZBDVUmu20XCDIIaqk122i4QZBDVUmu20WcAAD+/9YAAAAAAAAA=';
// const THIS_WAY_UP_BASE64 = 'data:image/webp;base64,UklGRjYBAABXRUJQVlA4WAoAAAAQAAAAxwAAxwAAQUxQSJoAAAABDzD/ERHCcWxbbfOUl5RAKZQGpVGKStDSkefwR/87Z09E/yeAdzesGc3Km0KqhFTpciPk5ozGQRgH3eSEyZ3RwgsLr9sEYRN05QRRKFFHCqQqScmmkipNJhsAmWw0ozTaDNKgmUgHYCKdZiEtbLzkNRsyANiQQVOkQkaDaESSAEhSgxJxXCL+v9A/lTLnN8+hao7pi45mvLsBVlA4IHYAAABQDACdASrIAMgAPm02mUmkIyKhIEgAgA2JaW7hdrEbQBPa9FXCDIIaqk122i4QZBDVUmu20XCDIIaqk122i4QZBDVUmu20XCDIIaqk122i4QZBDVUmu20XCDIIaqk122i4QZBDVUmu20WcAAD+/9YAAAAAAAAA=';
// const KEEP_DRY_BASE64 = 'data:image/webp;base64,UklGRvwBAABXRUJQVlA4WAoAAAAQAAAAxwAAxwAAQUxQSGABAAABDzD/ERFCkm3tbds8uCEd04yMLEOjYFvpxNKQnWAJGKow/FKon396Pyei/xOgH268Nbktv/2W4KYAT2jU4LJj0Hye8ozhUgtvmHGaWFxarl8BxakmCm9ciNyy27RIWC1DUvbRp8GjryTgzpZ5ZQIe8NhUtR4gcWvqZxIt1Wzanyn02GzLmYkRe7JUnQ9bmiFuGYY0Lm17Q+mXLVpmw1QhWGRlfa2aLm3NFG3dlIBwbpgyNMPeVGAYZtMEs2Hxkx0WnIKlbri0tA2RV+f6pp1X4tOV8aVky/5LKZb5S5ksy2fISJr0TlIYMgW6FPVWymAqUCUUFl3C3pKApaCwF9CDIQL7jEIvQDPUAIyIQssAFoB+iUJNn6x+stoCCkSPunLhAZ/J+r+CffxBSZ8Hr+o0sl+heU30yaeL4dR0ORcvyalKyj5ISk6LFJ1m6dJpLwWnrgmnquzFHrfNv+nkph9uVlA4IHYAAABQDACdASrIAMgAPm02mUmkIyKhIEgAgA2JaW7hdrEbQBPa9FXCDIIaqk122i4QZBDVUmu20XCDIIaqk122i4QZBDVUmu20XCDIIaqk122i4QZBDVUmu20XCDIIaqk122i4QZBDVUmu20WcAAD+/9YAAAAAAAAA=';
// const BATTERY_INCLUDED = 'data:image/webp;base64,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\';\n\n// Define a default empty address\n// ... existing code ...\n